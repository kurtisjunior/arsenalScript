<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Arsenal Intelligence Brief - {{ report.match_id }}</title>

    <!--
        Arsenal Intelligence Brief - HTML Email Template
        Task: arsenalScript-vqp.37-41

        This template is designed for:
        - Email delivery (inline CSS for compatibility)
        - Mobile-responsive rendering
        - Professional Arsenal branding
    -->

    <style type="text/css">
        /* Reset styles for email clients */
        body, table, td, p, a, li, blockquote {
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }

        table, td {
            mso-table-lspace: 0pt;
            mso-table-rspace: 0pt;
        }

        img {
            -ms-interpolation-mode: bicubic;
            border: 0;
            height: auto;
            line-height: 100%;
            outline: none;
            text-decoration: none;
        }

        /* Base styles */
        body {
            margin: 0 !important;
            padding: 0 !important;
            width: 100% !important;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333333;
            background-color: #f5f5f5;
        }

        /* Container */
        .email-container {
            max-width: 680px;
            margin: 0 auto;
            background-color: #ffffff;
        }

        /* Arsenal brand colors */
        .arsenal-red { color: #EF0107; }
        .arsenal-navy { color: #063672; }
        .arsenal-gold { color: #9C824A; }

        /* Header section */
        .header {
            background: linear-gradient(135deg, #EF0107 0%, #9C0104 100%);
            padding: 30px 20px;
            text-align: center;
        }

        .header-logo {
            max-width: 80px;
            margin-bottom: 15px;
        }

        .header h1 {
            color: #ffffff;
            font-size: 28px;
            font-weight: 700;
            margin: 0 0 10px 0;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .header .match-title {
            color: #ffffff;
            font-size: 22px;
            font-weight: 600;
            margin: 0;
        }

        .header .match-meta {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            margin-top: 10px;
        }

        /* Completeness bar */
        .completeness-section {
            background-color: #f8f9fa;
            padding: 12px 20px;
            border-bottom: 1px solid #e9ecef;
        }

        .completeness-bar {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .completeness-label {
            font-size: 13px;
            font-weight: 600;
            color: #666;
        }

        .completeness-meter {
            flex: 1;
            height: 8px;
            background-color: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }

        .completeness-fill {
            height: 100%;
            background: linear-gradient(90deg, #EF0107, #9C824A);
            border-radius: 4px;
        }

        .completeness-value {
            font-size: 14px;
            font-weight: 700;
            color: #333;
        }

        /* Section styles */
        .section {
            padding: 25px 20px;
            border-bottom: 1px solid #e9ecef;
        }

        .section:last-child {
            border-bottom: none;
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-icon {
            width: 32px;
            height: 32px;
            background-color: #EF0107;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: white;
            font-weight: bold;
        }

        .section h2 {
            color: #063672;
            font-size: 20px;
            font-weight: 700;
            margin: 0;
            padding-bottom: 8px;
            border-bottom: 3px solid #EF0107;
        }

        .section-content {
            font-size: 15px;
            color: #333;
        }

        /* Fixture info */
        .fixture-card {
            background: linear-gradient(135deg, #063672 0%, #0a4a9c 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }

        .fixture-teams {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .team-name {
            font-size: 18px;
            font-weight: 700;
        }

        .vs-badge {
            background-color: #EF0107;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
        }

        .fixture-details {
            font-size: 14px;
            opacity: 0.9;
        }

        /* Odds table */
        .odds-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .odds-table th {
            background-color: #063672;
            color: white;
            padding: 14px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .odds-table td {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
            font-size: 14px;
        }

        .odds-table tr:last-child td {
            border-bottom: none;
        }

        .odds-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .odds-table .best-odds {
            color: #28a745;
            font-weight: 700;
        }

        /* Prediction card */
        .prediction-card {
            text-align: center;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .prediction-card.win {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border: 2px solid #28a745;
        }

        .prediction-card.draw {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%);
            border: 2px solid #ffc107;
        }

        .prediction-card.loss {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border: 2px solid #dc3545;
        }

        .prediction-outcome {
            font-size: 48px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .prediction-card.win .prediction-outcome { color: #155724; }
        .prediction-card.draw .prediction-outcome { color: #856404; }
        .prediction-card.loss .prediction-outcome { color: #721c24; }

        .prediction-label {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .prediction-confidence {
            font-size: 16px;
            font-weight: 600;
        }

        /* Probability bars */
        .prob-bars {
            margin: 25px 0;
        }

        .prob-item {
            margin-bottom: 15px;
        }

        .prob-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 14px;
        }

        .prob-label {
            font-weight: 600;
            color: #333;
        }

        .prob-value {
            font-weight: 700;
        }

        .prob-bar-bg {
            height: 24px;
            background-color: #e9ecef;
            border-radius: 12px;
            overflow: hidden;
        }

        .prob-bar-fill {
            height: 100%;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-size: 12px;
            font-weight: 600;
        }

        .prob-bar-fill.win { background: linear-gradient(90deg, #28a745, #20c997); }
        .prob-bar-fill.draw { background: linear-gradient(90deg, #ffc107, #ffca2c); }
        .prob-bar-fill.loss { background: linear-gradient(90deg, #dc3545, #e74c3c); }

        /* Sentiment gauge */
        .sentiment-gauge {
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            margin: 15px 0;
        }

        .sentiment-gauge.positive {
            background-color: #d4edda;
            border: 2px solid #28a745;
        }

        .sentiment-gauge.neutral {
            background-color: #fff3cd;
            border: 2px solid #ffc107;
        }

        .sentiment-gauge.negative {
            background-color: #f8d7da;
            border: 2px solid #dc3545;
        }

        .sentiment-label {
            font-size: 24px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .sentiment-score {
            font-size: 32px;
            font-weight: 800;
        }

        /* Value betting */
        .value-card {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }

        .value-card.high-value {
            background-color: #d4edda;
            border-left-color: #155724;
        }

        .value-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .value-market {
            font-weight: 700;
            font-size: 16px;
            color: #333;
        }

        .value-ev {
            background-color: #28a745;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-weight: 700;
            font-size: 14px;
        }

        .value-details {
            display: flex;
            gap: 20px;
            font-size: 13px;
            color: #666;
        }

        .value-detail {
            display: flex;
            flex-direction: column;
        }

        .value-detail-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #888;
        }

        .value-detail-value {
            font-weight: 600;
            color: #333;
        }

        /* News items */
        .news-item {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .news-item:last-child {
            border-bottom: none;
        }

        .news-title {
            font-weight: 600;
            font-size: 15px;
            color: #063672;
            margin-bottom: 5px;
        }

        .news-title a {
            color: #063672;
            text-decoration: none;
        }

        .news-title a:hover {
            text-decoration: underline;
        }

        .news-source {
            font-size: 12px;
            color: #888;
        }

        .news-summary {
            font-size: 14px;
            color: #666;
            margin-top: 8px;
        }

        /* Quotes */
        .quote-block {
            background-color: #f8f9fa;
            border-left: 4px solid #EF0107;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .quote-text {
            font-size: 15px;
            font-style: italic;
            color: #333;
            margin-bottom: 10px;
        }

        .quote-author {
            font-size: 13px;
            color: #666;
            font-weight: 600;
        }

        /* Charts */
        .chart-container {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 12px;
        }

        .chart-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
        }

        .chart-title {
            font-size: 13px;
            color: #666;
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Unavailable section */
        .unavailable-notice {
            background-color: #f8f9fa;
            color: #888;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            font-style: italic;
        }

        /* Warnings */
        .warnings-list {
            background-color: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 12px 15px;
            margin: 15px 0;
        }

        .warning-item {
            font-size: 13px;
            color: #856404;
            margin: 5px 0;
        }

        /* Footer */
        .footer {
            background-color: #063672;
            color: #ffffff;
            padding: 25px 20px;
            text-align: center;
        }

        .footer-logo {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .footer-text {
            font-size: 12px;
            opacity: 0.8;
            line-height: 1.8;
        }

        .footer-disclaimer {
            font-size: 11px;
            opacity: 0.6;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.2);
        }

        /* Mobile responsive */
        @media only screen and (max-width: 600px) {
            .email-container {
                width: 100% !important;
            }

            .header {
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 22px;
            }

            .header .match-title {
                font-size: 18px;
            }

            .section {
                padding: 20px 15px;
            }

            .section h2 {
                font-size: 18px;
            }

            .fixture-teams {
                flex-direction: column;
                gap: 10px;
            }

            .odds-table th,
            .odds-table td {
                padding: 10px 8px;
                font-size: 12px;
            }

            .prediction-outcome {
                font-size: 36px;
            }

            .value-details {
                flex-wrap: wrap;
            }

            .prob-header {
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <center>
        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
            <tr>
                <td style="background-color: #f5f5f5; padding: 20px 0;">
                    <table class="email-container" role="presentation" cellspacing="0" cellpadding="0" border="0" width="680" style="margin: 0 auto;">

                        <!-- Header -->
                        <tr>
                            <td class="header">
                                <h1>Arsenal Intelligence Brief</h1>
                                <div class="match-title">{{ report.home_team }} vs {{ report.away_team }}</div>
                                <div class="match-meta">
                                    {{ report.competition }} | {{ report.match_date or 'Date TBD' }}<br>
                                    Match ID: {{ report.match_id }}
                                </div>
                            </td>
                        </tr>

                        <!-- Data Completeness Bar -->
                        <tr>
                            <td class="completeness-section">
                                <div class="completeness-bar">
                                    <span class="completeness-label">Data Completeness:</span>
                                    <div class="completeness-meter">
                                        <div class="completeness-fill" style="width: {{ report.data_completeness.completeness_score }}%;"></div>
                                    </div>
                                    <span class="completeness-value">{{ report.data_completeness.completeness_score|round(0) }}%</span>
                                </div>
                                {% if report.data_completeness.warnings %}
                                <div class="warnings-list" style="margin-top: 10px;">
                                    {% for warning in report.data_completeness.warnings %}
                                    <div class="warning-item">{{ warning }}</div>
                                    {% endfor %}
                                </div>
                                {% endif %}
                            </td>
                        </tr>

                        <!-- Sections -->
                        {% for section in report.sections %}
                        <tr>
                            <td class="section">
                                <h2>{{ section.title }}</h2>

                                {% if section.is_available %}

                                    {% if section.title == 'Fixture Information' %}
                                    <!-- Fixture Info Section -->
                                    <div class="fixture-card">
                                        <div class="fixture-teams">
                                            <span class="team-name">{{ report.home_team }}</span>
                                            <span class="vs-badge">VS</span>
                                            <span class="team-name">{{ report.away_team }}</span>
                                        </div>
                                        <div class="fixture-details">
                                            <strong>{{ report.competition }}</strong><br>
                                            {% if report.match_date %}{{ report.match_date }}{% else %}Date TBD{% endif %}<br>
                                            {% if 'Arsenal' in report.home_team %}Emirates Stadium{% else %}Away Venue{% endif %}
                                        </div>
                                    </div>

                                    {% elif section.title == 'Odds Comparison' %}
                                    <!-- Odds Comparison Section -->
                                    {% if report.raw_data.odds %}
                                    <table class="odds-table">
                                        <tr>
                                            <th>Outcome</th>
                                            <th>Best Odds</th>
                                            <th>Bookmaker</th>
                                        </tr>
                                        {% if report.raw_data.odds.best_value %}
                                        <tr>
                                            <td><strong>{{ report.home_team }} Win</strong></td>
                                            <td class="best-odds">{{ report.raw_data.odds.best_value.home_win.odds }}</td>
                                            <td>{{ report.raw_data.odds.best_value.home_win.bookmaker }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Draw</strong></td>
                                            <td class="best-odds">{{ report.raw_data.odds.best_value.draw.odds }}</td>
                                            <td>{{ report.raw_data.odds.best_value.draw.bookmaker }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>{{ report.away_team }} Win</strong></td>
                                            <td class="best-odds">{{ report.raw_data.odds.best_value.away_win.odds }}</td>
                                            <td>{{ report.raw_data.odds.best_value.away_win.bookmaker }}</td>
                                        </tr>
                                        {% endif %}
                                    </table>

                                    {% if report.charts.odds_comparison %}
                                    <div class="chart-container">
                                        <img src="data:image/png;base64,{{ report.charts.odds_comparison }}" alt="Odds Comparison Chart">
                                        <div class="chart-title">Bookmaker Odds Comparison</div>
                                    </div>
                                    {% endif %}
                                    {% endif %}

                                    {% elif section.title == 'ML Prediction' %}
                                    <!-- ML Prediction Section -->
                                    {% if report.raw_data.ml_prediction %}
                                    {% set pred = report.raw_data.ml_prediction %}
                                    {% set outcome = pred.predicted_outcome|default('D') %}
                                    {% set outcome_class = 'win' if outcome == 'W' else ('draw' if outcome == 'D' else 'loss') %}

                                    <div class="prediction-card {{ outcome_class }}">
                                        <div class="prediction-label">Predicted Outcome</div>
                                        <div class="prediction-outcome">{{ outcome }}</div>
                                        <div class="prediction-confidence">
                                            {% set conf = pred.prediction_confidence|default(pred.confidence|default(0)) %}
                                            Model Confidence: {{ conf if conf > 1 else conf * 100 }}%
                                        </div>
                                    </div>

                                    {% if pred.probabilities %}
                                    <div class="prob-bars">
                                        {% set probs = pred.probabilities %}
                                        {% set win = probs.win|default(probs.win_prob|default(0)) %}
                                        {% set draw = probs.draw|default(probs.draw_prob|default(0)) %}
                                        {% set loss = probs.loss|default(probs.loss_prob|default(0)) %}
                                        {% set win_pct = win if win > 1 else win * 100 %}
                                        {% set draw_pct = draw if draw > 1 else draw * 100 %}
                                        {% set loss_pct = loss if loss > 1 else loss * 100 %}

                                        <div class="prob-item">
                                            <div class="prob-header">
                                                <span class="prob-label">{{ report.home_team }} Win</span>
                                                <span class="prob-value">{{ "%.1f"|format(win_pct) }}%</span>
                                            </div>
                                            <div class="prob-bar-bg">
                                                <div class="prob-bar-fill win" style="width: {{ win_pct }}%;"></div>
                                            </div>
                                        </div>

                                        <div class="prob-item">
                                            <div class="prob-header">
                                                <span class="prob-label">Draw</span>
                                                <span class="prob-value">{{ "%.1f"|format(draw_pct) }}%</span>
                                            </div>
                                            <div class="prob-bar-bg">
                                                <div class="prob-bar-fill draw" style="width: {{ draw_pct }}%;"></div>
                                            </div>
                                        </div>

                                        <div class="prob-item">
                                            <div class="prob-header">
                                                <span class="prob-label">{{ report.away_team }} Win</span>
                                                <span class="prob-value">{{ "%.1f"|format(loss_pct) }}%</span>
                                            </div>
                                            <div class="prob-bar-bg">
                                                <div class="prob-bar-fill loss" style="width: {{ loss_pct }}%;"></div>
                                            </div>
                                        </div>
                                    </div>
                                    {% endif %}

                                    {% if report.charts.probability_gauge %}
                                    <div class="chart-container">
                                        <img src="data:image/png;base64,{{ report.charts.probability_gauge }}" alt="Probability Gauge">
                                        <div class="chart-title">Win Probability Distribution</div>
                                    </div>
                                    {% endif %}
                                    {% endif %}

                                    {% elif section.title == 'Sentiment Analysis' %}
                                    <!-- Sentiment Section -->
                                    {% if report.raw_data.sentiment %}
                                    {% set sent = report.raw_data.sentiment %}
                                    {% set sent_label = sent.overall_label|default('neutral') %}
                                    {% set sent_class = 'positive' if sent_label == 'positive' else ('negative' if sent_label == 'negative' else 'neutral') %}

                                    <div class="sentiment-gauge {{ sent_class }}">
                                        <div class="sentiment-label">{{ sent_label|upper }}</div>
                                        <div class="sentiment-score">{{ "%.2f"|format(sent.overall_sentiment|default(0)) }}</div>
                                    </div>

                                    {% if sent.key_insights %}
                                    <h4 style="margin-top: 20px; color: #063672;">Key Insights</h4>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        {% for insight in sent.key_insights[:5] %}
                                        <li style="margin: 8px 0; font-size: 14px;">{{ insight }}</li>
                                        {% endfor %}
                                    </ul>
                                    {% endif %}

                                    {% if report.charts.sentiment_timeline %}
                                    <div class="chart-container">
                                        <img src="data:image/png;base64,{{ report.charts.sentiment_timeline }}" alt="Sentiment Timeline">
                                        <div class="chart-title">Sentiment Over Time</div>
                                    </div>
                                    {% endif %}
                                    {% endif %}

                                    {% elif section.title == 'Value Betting' %}
                                    <!-- Value Betting Section -->
                                    {% if report.raw_data.value %}
                                    {% set val = report.raw_data.value %}
                                    {% set opps = val.opportunities|default([]) %}

                                    {% if opps %}
                                    <p style="margin-bottom: 15px; font-size: 14px; color: #666;">
                                        <strong>{{ opps|length }}</strong> opportunities identified |
                                        <strong>{{ val.high_value_count|default(0) }}</strong> high value (EV > 5%)
                                    </p>

                                    {% for opp in opps[:5] %}
                                    <div class="value-card {{ 'high-value' if opp.is_high_value else '' }}">
                                        <div class="value-header">
                                            <span class="value-market">{{ opp.market|replace('_', ' ')|title }}</span>
                                            <span class="value-ev">EV: {{ "%.1f"|format(opp.expected_value_percentage) }}%</span>
                                        </div>
                                        <div class="value-details">
                                            <div class="value-detail">
                                                <span class="value-detail-label">Edge</span>
                                                <span class="value-detail-value">{{ "%.1f"|format(opp.edge_percentage) }}%</span>
                                            </div>
                                            <div class="value-detail">
                                                <span class="value-detail-label">Odds</span>
                                                <span class="value-detail-value">{{ "%.2f"|format(opp.decimal_odds) }}</span>
                                            </div>
                                            <div class="value-detail">
                                                <span class="value-detail-label">Bookmaker</span>
                                                <span class="value-detail-value">{{ opp.bookmaker }}</span>
                                            </div>
                                            <div class="value-detail">
                                                <span class="value-detail-label">Risk</span>
                                                <span class="value-detail-value">{{ opp.risk_level|replace('_', ' ')|title }}</span>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}

                                    {% if val.summary and val.summary.recommendation %}
                                    <p style="margin-top: 15px; padding: 12px; background-color: #e7f3ff; border-radius: 8px; font-size: 14px;">
                                        <strong>Recommendation:</strong> {{ val.summary.recommendation }}
                                    </p>
                                    {% endif %}

                                    {% if report.charts.value_opportunities %}
                                    <div class="chart-container">
                                        <img src="data:image/png;base64,{{ report.charts.value_opportunities }}" alt="Value Opportunities">
                                        <div class="chart-title">Value Betting Opportunities</div>
                                    </div>
                                    {% endif %}

                                    {% else %}
                                    <div class="unavailable-notice">No value betting opportunities identified for this match.</div>
                                    {% endif %}
                                    {% endif %}

                                    {% elif section.title == 'News & Injuries' %}
                                    <!-- News Section -->
                                    {% if report.raw_data.news %}
                                    {% set news = report.raw_data.news %}

                                    {% if news.articles %}
                                    <h4 style="color: #063672; margin-bottom: 15px;">Recent News</h4>
                                    {% for article in news.articles[:5] %}
                                    <div class="news-item">
                                        <div class="news-title">
                                            <a href="{{ article.url|default('#') }}">{{ article.title|default('Untitled') }}</a>
                                        </div>
                                        <div class="news-source">{{ article.source|default('Unknown Source') }}</div>
                                        {% if article.summary %}
                                        <div class="news-summary">{{ article.summary[:150] }}...</div>
                                        {% endif %}
                                    </div>
                                    {% endfor %}
                                    {% endif %}

                                    {% if news.quotes %}
                                    <h4 style="color: #063672; margin: 25px 0 15px 0;">Key Quotes</h4>
                                    {% for quote in news.quotes[:3] %}
                                    <div class="quote-block">
                                        <div class="quote-text">"{{ quote.quote[:200] }}{% if quote.quote|length > 200 %}...{% endif %}"</div>
                                        <div class="quote-author">- {{ quote.speaker|default('Unknown') }}</div>
                                    </div>
                                    {% endfor %}
                                    {% endif %}
                                    {% endif %}

                                    {% else %}
                                    <!-- Generic section content -->
                                    {{ section.html_content|safe if section.html_content else section.content|e }}
                                    {% endif %}

                                {% else %}
                                <!-- Section data unavailable -->
                                <div class="unavailable-notice">
                                    {{ section.title }} data is not available for this report.
                                </div>
                                {% endif %}

                            </td>
                        </tr>
                        {% endfor %}

                        <!-- Footer -->
                        <tr>
                            <td class="footer">
                                <div class="footer-logo">ARSENAL INTELLIGENCE BRIEF</div>
                                <div class="footer-text">
                                    Match ID: {{ report.match_id }}<br>
                                    Generated: {{ report.generated_at }}
                                </div>
                                <div class="footer-disclaimer">
                                    This report is generated automatically by the Arsenal Intelligence Brief system.
                                    Data accuracy depends on source availability. Betting involves risk.
                                    Please gamble responsibly.
                                </div>
                            </td>
                        </tr>

                    </table>
                </td>
            </tr>
        </table>
    </center>
</body>
</html>
